import 'enums.dart';
import 'exercise.dart';

class DailyWorkout {
  final TrainingDay day;
  final String focus;
  final List<Exercise> exercises;
  final bool isRestDay;

  const DailyWorkout({
    required this.day,
    required this.focus,
    required this.exercises,
    this.isRestDay = false,
  });

  Map<String, dynamic> toJson() => {
        'day': day.name,
        'focus': focus,
        'exercises': exercises.map((e) => e.toJson()).toList(),
        'isRestDay': isRestDay,
      };

  factory DailyWorkout.fromJson(Map<String, dynamic> json) => DailyWorkout(
        day: TrainingDay.values.firstWhere((d) => d.name == json['day']),
        focus: json['focus'] as String,
        exercises: (json['exercises'] as List)
            .map((e) => Exercise.fromJson(e as Map<String, dynamic>))
            .toList(),
        isRestDay: json['isRestDay'] as bool? ?? false,
      );

  factory DailyWorkout.rest(TrainingDay day) => DailyWorkout(
        day: day,
        focus: 'Rest & Recovery',
        exercises: const [],
        isRestDay: true,
      );

  int get exerciseCount => exercises.length;
  
  List<Exercise> get mainLifts => exercises.where((e) => e.isMain).toList();
}